<div class="panel panel-default">
    <div class="panel-heading">编辑试题</div>
    <div class="panel-body">

        <div class="form-group">
            <label class="col-xs-12 col-sm-3 col-md-2 control-label">试卷标题</label>
                <div class="col-sm-9 col-xs-12 form-control-static">
                {$item['title']}
            </div>
        </div>
        <div class="form-group">
            <label class="col-xs-12 col-sm-3 col-md-2 control-label">试卷年份</label>

            <div class="col-sm-9 col-xs-12 form-control-static">
                {$item['year']}
            </div>
        </div>
        <div class="form-group">
            <label class="col-xs-12 col-sm-3 col-md-2 control-label">试卷分制</label>

            <div class="col-sm-9 col-xs-12 form-control-static">
                {$type_item['score']}分
            </div>
        </div>
        <div class="form-group">
            <label class="col-xs-12 col-sm-3 col-md-2 control-label">试卷时间</label>

            <div class="col-sm-9 col-xs-12 form-control-static">
                {$type_item['times']}分钟
            </div>
        </div>
        <div class="form-group">
            <label class="col-xs-12 col-sm-3 col-md-2 control-label">当前题数</label>
            <div class="col-sm-9 col-xs-12 form-control-static">
                {loop $types $key $value}
                {if $value['has'] == 1}
                {$types_config[$key]}({$now_question_data[$key]['num']}/{$value['num']}道)&nbsp;&nbsp;
                {/if}
                {/loop}
            </div>
        </div>

        <div class='form-group'>
            <label class="col-xs-12 col-sm-3 col-md-2 col-lg-1 control-label"></label>
            <div class="col-sm-9">
                <div class="panel panel-default">
                    <div class="panel-heading">试题信息</div>
                    <div class="panel-body">
                        <table class='table table-bordered'>
                            {php $i = 0;}
                            {loop $types $key $value}

                            {if $value['has'] == 1}
                            <tr>
                                <td colspan="4">
                                    <H4>{$types_config[$key]}({$now_question_data[$key]['num']}/{$value['num']}道)</H4>
                                    {if $now_question_data[$key]['num'] < $value['num']}
                                    <label class="inline">
                                        <a href='{php echo $this->createWebUrl('question', array('op'=>'edit','paperid'=>$id,'referer'=>1,'type_key'=>$key));}'>添加新的{$types_config[$key]}</a>
                                        &nbsp;&nbsp;&nbsp;
                                        <a href='{php echo $this->createWebUrl('question', array('type'=>$key,'add_paper'=>1,'referer'=>1,'paperid'=>$id));}'>从已有{$types_config[$key]}列表中选择</a>
                                        &nbsp;&nbsp;&nbsp;
                                        <a href='{php echo $this->createWebUrl('pool', array('type'=>$key,'add_paper'=>1,'referer'=>1,'paperid'=>$id));}'>自动填充所有试题</a>
                                    </label>
                                    {/if}
                                </td>
                            </tr>

                            {if $key == 1}
                            {loop $question_item $k $v}
                            {if $v['type'] == $key}
                            {php $i++}
                            <tr>
                                <td width="15%;">第{$i}题：</td>
                                <td>
                                    <input type="text" value="{$v['displayorder']}" this_id="{$v['id']}" class="question_order form-control" name="displayorder[{$v['id']}]">
                                </td>
                                <td>
                                    <input type='text' class='form-control' name='question[]' value="{$v['question']}" disabled=""/>
                                </td>
                                <td>
                                    <label class="inline">
                                        <a class="btn btn-default btn-sm" href='{php echo $this->createWebUrl('question',array('op'=>'edit','id'=>$v['id'],'paperid'=>$id,'referer'=>1));}'>
                                            <i class='fa fa-edit'></i>编辑
                                        </a>
                                        &nbsp;&nbsp;
                                        <button type="button" class="btn btn-default btn-sm del_question" href='javascript:void(0);' this_id="{$v['id']}">
                                            <i class='fa fa-times'>删除</i>
                                        </button>
                                    </label>
                                </td>
                            </tr>
                            {/if}
                            {/loop}
                            {/if}

                            {if $key == 2}
                            {loop $question_item $k $v}
                            {if $v['type'] == $key}
                            {php $i++}
                            <tr>
                                <td width="15%;">第{$i}题：</td>
                                <td>
                                    <input type="text" value="{$v['displayorder']}" this_id="{$v['id']}" class="question_order form-control" name="displayorder[{$v['id']}]">
                                </td>
                                </td>
                                <td>
                                    <input type='text' class='form-control' name='question' value="{$v['question']}" disabled=""/>
                                </td>
                                <td>
                                    <label class="inline">
                                        <a class="btn btn-default btn-sm" href='{php echo $this->createWebUrl('question',array('op'=>'edit','id'=>$v['id'],'paperid'=>$id,'referer'=>1));}'>
                                            <i class='fa fa-edit'></i> 编辑
                                        </a>
                                        &nbsp;&nbsp;
                                        <button type="button" class="btn btn-default btn-sm del_question" href='javascript:void(0);' this_id="{$v['id']}">
                                            <i class='fa fa-times'>删除</i>
                                        </button>
                                    </label>
                                </td>
                            </tr>
                            {/if}
                            {/loop}
                            {/if}

                            {if $key == 3}
                            {loop $question_item $k $v}
                            {if $v['type'] == $key}
                            {php $i++}
                            <tr>
                                <td width="15%;">第{$i}题：</td>
                                <td>
                                    <input type="text" value="{$v['displayorder']}" this_id="{$v['id']}" class="question_order form-control" name="displayorder[{$v['id']}]">
                                </td>
                                </td>
                                <td>
                                    <input type='text' class='form-control' name='question' value="{$v['question']}" disabled=""/>
                                </td>
                                <td>
                                    <label class="inline">
                                        <a class="btn btn-default btn-sm" href='{php echo $this->createWebUrl('question',array('op'=>'edit','id'=>$v['id'],'paperid'=>$id,'referer'=>1));}'>
                                            <i class='fa fa-edit'></i> 编辑
                                        </a>
                                        &nbsp;&nbsp;
                                        <button type="button" class="btn btn-default btn-sm del_question" href='javascript:void(0);' this_id="{$v['id']}">
                                            <i class='fa fa-times'>删除</i>
                                        </button>
                                    </label>
                                </td>
                            </tr>
                            {/if}
                            {/loop}
                            {/if}

                            {/if}
                            {/loop}
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<script type="text/javascript">
    $('.del_question').click(function () {
        var id = $(this).attr('this_id');
        var msg = '您确定要将该题从此试卷删除吗';
        var url = "{php echo $this->createWebUrl('question',array('op' => 'deleteFromPaper', 'paperid' => $id))}" + "&id="+id;
        if (confirm(msg)){
            window.location = url;
        }
    })
</script>
   