var WeixinApi=(function(){function m(r,q){q=q||{};var p=function(s){WeixinJSBridge.invoke("shareTimeline",{appid:s.appId?s.appId:"",img_url:s.imgUrl,link:s.link,desc:s.title,title:s.desc,img_width:"640",img_height:"640"},function(t){switch(t.err_msg){case"share_timeline:cancel":q.cancel&&q.cancel(t);break;case"share_timeline:confirm":case"share_timeline:ok":q.confirm&&q.confirm(t);break;case"share_timeline:fail":default:q.fail&&q.fail(t);break}q.all&&q.all(t)})};WeixinJSBridge.on("menu:share:timeline",function(s){if(q.async&&q.ready){window._wx_loadedCb_=q.dataLoaded||new Function();if(window._wx_loadedCb_.toString().indexOf("_wx_loadedCb_")>0){window._wx_loadedCb_=new Function()}q.dataLoaded=function(t){window._wx_loadedCb_(t);p(t)};q.ready&&q.ready(s)}else{q.ready&&q.ready(s);p(r)}})}function l(r,q){q=q||{};var p=function(s){WeixinJSBridge.invoke("sendAppMessage",{appid:s.appId?s.appId:"",img_url:s.imgUrl,link:s.link,desc:s.desc,title:s.title,img_width:"640",img_height:"640"},function(t){switch(t.err_msg){case"send_app_msg:cancel":q.cancel&&q.cancel(t);break;case"send_app_msg:confirm":case"send_app_msg:ok":q.confirm&&q.confirm(t);break;case"send_app_msg:fail":default:q.fail&&q.fail(t);break}q.all&&q.all(t)})};WeixinJSBridge.on("menu:share:appmessage",function(s){if(q.async&&q.ready){window._wx_loadedCb_=q.dataLoaded||new Function();if(window._wx_loadedCb_.toString().indexOf("_wx_loadedCb_")>0){window._wx_loadedCb_=new Function()}q.dataLoaded=function(t){window._wx_loadedCb_(t);p(t)};q.ready&&q.ready(s)}else{q.ready&&q.ready(s);p(r)}})}function i(r,q){q=q||{};var p=function(s){WeixinJSBridge.invoke("shareWeibo",{content:s.desc,url:s.link},function(t){switch(t.err_msg){case"share_weibo:cancel":q.cancel&&q.cancel(t);break;case"share_weibo:confirm":case"share_weibo:ok":q.confirm&&q.confirm(t);break;case"share_weibo:fail":default:q.fail&&q.fail(t);break}q.all&&q.all(t)})};WeixinJSBridge.on("menu:share:weibo",function(s){if(q.async&&q.ready){window._wx_loadedCb_=q.dataLoaded||new Function();if(window._wx_loadedCb_.toString().indexOf("_wx_loadedCb_")>0){window._wx_loadedCb_=new Function()}q.dataLoaded=function(t){window._wx_loadedCb_(t);p(t)};q.ready&&q.ready(s)}else{q.ready&&q.ready(s);p(r)}})}function n(r,q){q=q||{};var p=function(t,s){if(t.shareTo=="timeline"){var u=s.title;s.title=s.desc||u;s.desc=u}t.generalShare({appid:s.appId?s.appId:"",img_url:s.imgUrl,link:s.link,desc:s.desc,title:s.title,img_width:"640",img_height:"640"},function(v){switch(v.err_msg){case"general_share:cancel":q.cancel&&q.cancel(v,t.shareTo);break;case"general_share:confirm":case"general_share:ok":q.confirm&&q.confirm(v,t.shareTo);break;case"general_share:fail":default:q.fail&&q.fail(v,t.shareTo);break}q.all&&q.all(v,t.shareTo)})};WeixinJSBridge.on("menu:general:share",function(s){if(q.async&&q.ready){window._wx_loadedCb_=q.dataLoaded||new Function();if(window._wx_loadedCb_.toString().indexOf("_wx_loadedCb_")>0){window._wx_loadedCb_=new Function()}q.dataLoaded=function(t){window._wx_loadedCb_(t);p(s,t)};q.ready&&q.ready(s,s.shareTo)}else{q.ready&&q.ready(s,s.shareTo);p(s,r)}})}function d(p,q){q=q||{};WeixinJSBridge.invoke("addContact",{webtype:"1",username:p},function(s){var r=!s.err_msg||"add_contact:ok"==s.err_msg||"add_contact:added"==s.err_msg;if(r){q.success&&q.success(s)}else{q.fail&&q.fail(s)}})}function b(p,q){if(!p||!q||q.length==0){return}WeixinJSBridge.invoke("imagePreview",{current:p,urls:q})}function c(){WeixinJSBridge.call("showOptionMenu")}function k(){WeixinJSBridge.call("hideOptionMenu")}function j(){WeixinJSBridge.call("showToolbar")}function f(){WeixinJSBridge.call("hideToolbar")}function e(p){if(p&&typeof p=="function"){WeixinJSBridge.invoke("getNetworkType",{},function(q){p(q.err_msg)})}}function h(p){p=p||{};WeixinJSBridge.invoke("closeWindow",{},function(q){switch(q.err_msg){case"close_window:ok":p.success&&p.success(q);break;default:p.fail&&p.fail(q);break}})}function a(r){if(r&&typeof r=="function"){var p=this;var q=function(){r(p)};if(typeof window.WeixinJSBridge=="undefined"){if(document.addEventListener){document.addEventListener("WeixinJSBridgeReady",q,false)}else{if(document.attachEvent){document.attachEvent("WeixinJSBridgeReady",q);document.attachEvent("onWeixinJSBridgeReady",q)}}}else{q()}}}function o(){return/MicroMessenger/i.test(navigator.userAgent)}function g(p){p=p||{};WeixinJSBridge.invoke("scanQRCode",{},function(q){switch(q.err_msg){case"scan_qrcode:ok":p.success&&p.success(q);break;default:p.fail&&p.fail(q);break}})}return{version:"2.3",ready:a,shareToTimeline:m,shareToWeibo:i,shareToFriend:l,generalShare:n,addContact:d,showOptionMenu:c,hideOptionMenu:k,showToolbar:j,hideToolbar:f,getNetworkType:e,imagePreview:b,closeWindow:h,openInWeixin:o,scanQRCode:g}})();