define("app/weixinV2.1/book/customerReference",["gallery/zepto/1.1.3/zepto","app/weixinV2.1/book/utilities","app/weixinV2.1/book/language"],function(a){function b(){for(var a=x(),b=0;b<a.length;b++)for(var c=0;b>c;c++)if(a[b].phone==a[c].phone)return!0;return!1}function c(){for(var a=x(),b=0;b<a.length;b++)if(""==a[b].name||""==a[b].phone)return!0;return!1}function d(){for(var a=x(),b=/^0?(1)[0-9]{10}$/,c=0;c<a.length;c++)if(!b.test(a[c].phone))return!1;return!0}function e(){j(".remove").click(function(){1==j(".kelong").length?j(".remove").unbind("click"):(j(this).attr("jilu","jl"),w.show(),j(".byhei").show())})}function f(){var a=!1;return""==m.val()?h(l.emptyName):a=!0,a}function g(){var a=!1;if(""==n.val())h(l.emptyPhoneNumber);else{var b=/^0?(1)[0-9]{10}$/;u.hide(),b.test(n.val())?a=!0:h(l.invalidPhoneNumber)}return a}function h(a){k.showErrorMessage(a)}function i(){j("#mobileModal").one("click","a.guan",function(){return j.mobileModal.hideModal(),!1})}var j=a("gallery/zepto/1.1.3/zepto"),k=a("app/weixinV2.1/book/utilities"),l=a("app/weixinV2.1/book/language"),m=j(".cusinfor"),n=j(".cusphone"),o=j("#tianjia"),p=j("#tuijian"),q=j("#tianxie"),r=j(".nerror"),s=j(".perror"),t=j(".prul"),m=j("#cusinfor"),n=j("#cusphone"),u=(j("#namerror"),j("#phonerror")),v=(j("#phonerul"),j("#tijiao")),w=j("#tips"),x=function(){var a=[];return j(".kelong").each(function(){a.push({name:j(this).find(".cusinfor").val(),phone:j(this).find(".cusphone").val()})}),a};j(".xiayibu").click(function(){0==b()&&0==c()&&1==d()?(j("#jqueryclass").removeClass("none"),h(l.customerRecommendationFillSelfInfo),p.hide(),q.show()):1==c()?(j("#jqueryclass").addClass("none"),h(r.text())):1==b()?(j("#jqueryclass").addClass("none"),h(s.text())):0==d()&&(j("#jqueryclass").addClass("none"),h(t.text()))}),o.click(function(){var a=j("#infor").clone(!0);a.find("input").val(""),j(this).parent().before(a),e()}),j("#queren").click(function(){j('a[jilu="jl"]').parent().remove(),w.hide(),j(".byhei").hide()}),j("#quxiao").click(function(){j('a[jilu="jl"]').removeAttr("jilu"),w.hide(),j(".byhei").hide()}),v.click(function(){return f()&&g()&&(j(window).unbind("beforeunload"),j.ajax({type:"post",url:j("#listform").attr("action"),dataType:"text",data:j("#listform").serialize(),beforeSend:function(){j.mobileModal.buildContainer(),j.mobileModal.showModal(j("#loading-container").html())},success:function(a){var b=k.getDomBody(a);j.mobileModal.showModal(b),i()},error:function(){}})),!1}),j(".xCon").on("click",function(){var a=j(this),b=j("p",this);a.toggleClass("xConClose"),a.hasClass("xConClose")?b.hide():b.show()})});